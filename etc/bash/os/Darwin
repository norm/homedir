# ~/etc/bash/os/Darwin
# -*- Mode: Bash; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 2 -*-
#
# bash startup commands specifically for OS X boxes

# OS X specific directories
export     JAVA_HOME="/System/Library/Frameworks/JavaVM.framework/Home"


# get the hostname and domain from the Sharing preference pane
export   HOST=`scutil --get LocalHostName | sed -e "s/\..*//"`
export DOMAIN=`scutil --get LocalHostName | sed -e "s/${HOST}.//"`


# hibernation program
[ -x /usr/local/bin/deepsleep ]     && alias hibernate='sudo deepsleep'


# cd burning
alias mkiso='hdiutil makehybrid -iso -joliet'


# easy disk ejection
function eject {
    hdiutil eject /Volumes/$1
}


# prefer BSD vi to vim
need nvi <<end
    alias vi='nvi';
end


# open new tab in Terminal at current or given directory
function nt {
    local dir="${1:-$PWD}"

    osascript >/dev/null <<APPLESCRIPT
        tell application "System Events" 
            tell process "Terminal"
                keystroke "t" using command down
            end tell
        end tell
        tell application "Terminal"
            do script "cd ${dir}" in window 1
        end tell
APPLESCRIPT
}


# perform fast user switching without needing the menu extra visible
function uswitch {
    local menuextras='/System/Library/CoreServices/Menu Extras/'
    local   usermenu="${menuextras}/User.menu/Contents/Resources/CGSession"

    id=`id -u $1`
    case "$id" in
        $UID) 
            # do nothing
        ;;

        *)
            "$usermenu" -switchToUserID $id
        ;;
    esac
}
